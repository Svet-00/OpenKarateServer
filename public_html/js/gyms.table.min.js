$((function(){var e,a,t=$("#gymsTable"),d=t.data("getUrl"),l=t.data("addUrl"),r=t.data("editUrl"),n=t.data("deleteUrl"),i=$("#gymPicturesTable"),o=i.data("addUrl"),s=i.data("deleteUrl"),c=$("#gymPicturesTableContainer");c.hide();var u=$("#noGymSelectedInfo"),m=$("#gymPicturesCardBody");e=t.DataTable({scrollX:!0,language:{url:$(".table-responsive").data("translationUrl")},sPaginationType:"full_numbers",ajax:{url:d,dataSrc:""},columns:[{data:"id",visible:!1,searchable:!1,type:"hidden"},{data:"title",title:"Заголовок",unique:!0,required:!0},{data:"address",title:"Адрес",required:!0},{data:"description",title:"Описание",type:"textarea"},{data:"working_time",title:"Время работы",type:"textarea"},{data:"phone_number",title:"Номер телефона"},{data:"email",title:"Email"},{data:"vk_link",title:"Ссылка ВК"}],dom:"Bfrtip",select:"single",responsive:!1,altEditor:!0,buttons:[{text:"Добавить",name:"add"},{extend:"selected",text:"Редактировать",name:"edit"},{extend:"selected",text:"Удалить",name:"delete"},{text:"Обновить",name:"refresh"},{text:"Экспорт в excel",extend:"excelHtml5",exportOptions:{columns:":visible"}}],onAddRow:function(e,a,t,d){$.ajax({url:l,method:"POST",data:a,success:t,error:d,dataType:"json"})},onDeleteRow:function(e,a,t,d){$.ajax({url:n.replace("id",a.id),method:"DELETE",data:a,success:t,error:d,dataType:"json"})},onEditRow:function(e,a,t,d){$.ajax({url:r.replace("id",a.id),method:"POST",data:a,success:t,error:d,dataType:"json"})}}),a=i.DataTable({scrollX:!0,language:{url:$(".table-responsive").data("translationUrl")},sPaginationType:"full_numbers",data:[],columns:[{data:"id",visible:!1,searchable:!1,type:"hidden"},{data:"url",title:"Изображение",searchable:!1,render:function(e,a,t){if(e)return"<img style='max-width:300px;max-height:300px' src="+e+"></img>"},type:"file",accept:"image/jpeg,image/png"}],dom:"Bfrtip",select:"single",responsive:!1,altEditor:!0,buttons:[{text:"Добавить",name:"add"},{extend:"selected",text:"Удалить",name:"delete"}],onAddRow:function(a,t,d,l){const r=new FormData;r.append("file",t.url[0],t.url[0].name),$.ajax(o.replace("id",i.data("gymId")),{method:"post",data:r,processData:!1,contentType:!1,success:d,error:l}),e.ajax.reload(null,!1)},onDeleteRow:function(a,t,d,l){$.ajax({url:s.replace("id",t.id),method:"DELETE",data:t,success:d,error:l,dataType:"json",processData:!1}),e.ajax.reload(null,!1)}}),e.on("select",(function(t,d,l,r){if("row"===l){u.hide(),m.removeClass("border-left-info"),c.show();var n=e.row(r[0]).data();i.data("gymId",n.id),a.clear(),a.rows.add(n.photos),a.draw()}})),e.on("deselect",(function(e,a,t,d){"row"===t&&(c.hide(),m.addClass("border-left-info"),u.show())}))}));